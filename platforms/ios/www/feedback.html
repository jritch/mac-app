<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]>      <html class="no-js"> <![endif]-->

 <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><title>Age-CAP</title>

		<meta name="description" content="">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">


		<link rel="stylesheet" href="css/bootstrap.min.css">
		<link rel="stylesheet" href="css/bootstrapresponsive.min.css">
		<link rel="stylesheet" href="css/main.css">

		<script src="js/vendor/modernizr262respond110min.js"></script>
		<script type="text/javascript" src="http://code.jquery.com/jquery-1.10.0.js"></script>
		<script type="text/javascript" src="Handlebars.js"></script>
		<script type="text/javascript" src="templates/templates.js"></script>
		</head>

<body> 

<div class="shoesNav container-fluid"></div>

<script src="js/vendor/bootstrap.min.js"></script>

<script src="js/main.js"></script>      

      <div class="navbar navbar-fixed-top">
          <div class="navbar-inner">

            <div class="container-fluid" id="header-container">
            
              <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>

              <div id="back-btn"> <button class="btn btn-primary" onClick="history.go(-1);return true;">BACK</button> </div>
              <a id="page-title" class="brand" href="#">Feedback</a>

              <div class="nav-collapse collapse">
                <ul class="nav">
                  <li><a href="index.html">Home   <span class="icon-home"></span></a></li>
                  <li> <a id="font-button">Change Font Size <span class="icon-font"></span></a></li>
                  <li> <a href="#myModal" data-toggle="modal">About Age-CAP</a></li>
                </ul>
              </div><!--/.nav-collapse -->

            </div>
          </div>
        </div>

 
	   
	   	<div class="row-fluid">
        <div class="span4 offset2">
        		<div class="question_background">
	                <div class="row-fluid">
	                        <h4 style="color:white">How was your experience using this app?</h4>
	                        <div class="spacer5"></div>
	                </div>

	                <div class="row-fluid">
	                    <div class="btn-group btn-group-vertical" data-toggle="buttons-radio" id="group1">
	                        <div class="btn-group">
	                            <button class="btn btn-large btn-primary"> 1 </button>                         
	                            <button class="btn btn-large btn-primary"> 2 </button>                         
	                            <button class="btn btn-large btn-primary"> 3 </button>                         
	                            <button class="btn btn-large btn-primary"> 4 </button>                         
	                            <button class="btn btn-large btn-primary"> 5 </button>
	                        </div>
	                    </div>
	                </div>
	 
	            </div>
	            <div class="percent-spacer"></div>
        </div>
	   
	   	<div class="span4">
	   			<div class="question_background">
	                <div class="row-fluid">
	                        <h4 style="color:white">How many times have you used this app before?</h4>
	                        <div class="spacer5"></div>
	                </div>

	                <div class="row-fluid">
	                    <div class="btn-group btn-group-vertical" data-toggle="buttons-radio" id="group2">
	                        <div class="btn-group">
	                            <button class="btn btn-large btn-primary"> 0 </button>                        
	                            <button class="btn btn-large btn-primary"> 1-4 </button>                         
	                            <button class="btn btn-large btn-primary"> 5-10</button>                         
	                            <button class="btn btn-large btn-primary"> >10 </button>
	                        </div>
	                    </div>
	                </div>
	 
	            </div>
	            <div class="percent-spacer"></div>
	   	</div></div>
	   
	   
	   
	   	<div class="row-fluid">
        <div class="span4 offset2">
        		<div class="question_background">
	                <div class="row-fluid">
	                        <h4 style="color:white">Was there an issue with the user interface?</h4>
	                        <div class="spacer5"></div>
	                </div>

	                <div class="row-fluid">
	                    <div class="btn-group btn-group-vertical" data-toggle="buttons-radio" id="group3">
	                        <div class="btn-group">
	                            <button class="btn btn-large btn-primary"> Yes </button>                         
	                            <button class="btn btn-large btn-primary"> No </button> 
	                        </div>
	                    </div>
	                </div>
	 
	            </div>
	            <div class="percent-spacer"></div>
        </div>
	  
	  	   	<div class="span4">
	   			<div class="question_background">
	                <div class="row-fluid">
	                        <h4 style="color:white">Was there an issue in the submission?</h4>
	                        <div class="spacer5"></div>
	                </div>

	                <div class="row-fluid">
	                    <div class="btn-group btn-group-vertical" data-toggle="buttons-radio" id="group4">
	                        <div class="btn-group">
	                           <button class="btn btn-large btn-primary"> Yes </button>                         
	                            <button class="btn btn-large btn-primary"> No </button> 
	                        </div>
	                    </div>
	                </div>
	 
	            </div>
	            <div class="percent-spacer"></div>
	   	</div></div>
	   
	   	<div class="row-fluid">
	   	<div class="span4 offset2">
	   			<div class="question_background">
	                <div class="row-fluid">
	                        <h4 style="color:white">Was there an issue in the performance? (e.g. crash, slow)</h4>
	                        <div class="spacer5"></div>
	                </div>

	                <div class="row-fluid">
	                    <div class="btn-group btn-group-vertical" data-toggle="buttons-radio" id="group5">
	                        <div class="btn-group">
	                           <button class="btn btn-large btn-primary"> Yes </button>                         
	                            <button class="btn btn-large btn-primary"> No </button> 
	                        </div>
	                    </div>
	                </div>
	 
	            </div>
	            <div class="percent-spacer"></div>
	   	</div>

        <div class="span4">
        		<div class="question_background">
	                <div class="row-fluid">
	                        <h4 style="color:white">Was there an issue in finding your location (GPS)? </h4>
	                        <div class="spacer5"></div>
	                </div>

	                <div class="row-fluid">
	                    <div class="btn-group btn-group-vertical" data-toggle="buttons-radio" id="group6">
	                        <div class="btn-group">
	                            <button class="btn btn-large btn-primary"> Yes </button>                         
	                            <button class="btn btn-large btn-primary"> No </button>
	                        </div>
	                        <!--<div class="percent-spacer"></div>-->
	                    </div>
	                </div>
	 
	            </div>
	            <div class="percent-spacer"></div>
        </div></div>
	   	   
	   	<div class="row-fluid">
	   	<div class="span4 offset2">
	   			<div class="question_background">	
	                <div class="row-fluid">
	                        <h4 style="color:white">Was there an issue in some other aspect?</h4>
	                        <div class="spacer5"></div>
	                </div>

	                <div class="row-fluid">
	                    <div class="btn-group btn-group-vertical" data-toggle="buttons-radio" id="group7">
	                        <div class="btn-group">
	                            <button class="btn btn-large btn-primary"> Yes </button>                         
	                            <button class="btn btn-large btn-primary"> No </button>
	                        </div>
	                    </div>
	                </div>
	 
	            </div>
	            <div class="percent-spacer"></div>
	   	</div>

	   <div class="span4">
	   	<div class="question_background">
			<h4 style="color:white">If you have any additional comments, please share them here:</h4> 
			<textarea rows="2" class="span12" id="comment"></textarea>
		</div>
	   </div>
	</div>

<div class="percent-spacer"></div>
<div class="row-fluid">

    <div class="span4 offset2">
    	<div class="question_background">
    		<h4 style="color:white">When you're ready, click this button to submit:</h4> 
    		<a class="btn btn-large btn-danger" id="submit">SUBMIT</a>
    	</div>
    </div>
</div>
	   

<div id="myModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">  
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
            <h3 id="myModalLabel">About Age-CAP</h3>
          </div>
          <div id="ModalText" class="modal-body">
            <p style=\'text-align:justify\'>Age-CAP is a smartphone application which aims to create a crowd-sourced database of age-friendly locations. It consists of survey styled forms which enable users to quickly rate a location. Users are also able to browse this database to assess the age-friendliness of locations in their neighborhood, providing them access to information which was otherwise unavailable. <br><br>Age-CAP was created by a multi-disciplinary team from the Toronto Rehabilitation Institute, University Health Network and University of Toronto.<br><br>Feedback or questions: iatsl@utoronto.ca</p>
          </div>
          <div class="modal-footer">
            <button class="btn btn-primary" data-dismiss="modal" aria-hidden="true">Close</button>
          </div>
        </div> 


<script>

//This fetches a bit of info about the location that is necessary
//for the Handlebars context

//Submission code handles calling the PHP script to 
//send the rating + location info to the database
$("#submit").click(function () {


	//This collects all the ratings inputted by the user
	var ratingsArray = [];
	i = 1;

	for (var j = 7; i <= j; i++) {
		name = "#group" + i + " .active";
		ratingsArray[i-1] = $.trim($(name).text());
    if (ratingsArray[i-1] == "")
    {
      ratingsArray[i-1] = "undefined";
    }
		if (!isNaN(ratingsArray[i-1]))
		{
			ratingsArray[i-1] = Number(ratingsArray[i-1]);
		}
	}

	//This bundles all the data into a JSON array so that it can be sent via POST
 	userID = localStorage.getItem("userID");
	submission =  { ratings:ratingsArray,
					comment:$("#comment").val(),
          			userID:userID
				  };
	console.log(submission);

	//store the submission so we can verify it's all a-okay (testing only)
	//localStorage.setItem("submission", JSON.stringify(submission));

	//Now POST it off!
	$.post('http://142.150.169.179/feedback.php', submission, function(data){
            // alert(data);
            console.log(data);
            old_location = localStorage.getItem("old_location")
            window.location.href = old_location;
          });


});

$("#comment").on("focus", function () {
    $(window).on("scroll", function(){
      console.log("bump");
      $("#comment").blur();
      $(window).off("scroll");
    });
});

</script>

</body>